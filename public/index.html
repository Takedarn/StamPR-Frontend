<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="styles/index.css">
    <title>kousei-ai</title>
</head>

<body>
    <div id="bodyContainer">
        <div id="appTitleArea">
            <h1 id="appLogo">校正AIくん</h1>
        </div>
    </div>
    <div id="inputSequenceFormContainer">
        <div>校正したい文章</div>
        <input type="text" id="inputSequenceForm" size="100" />
    </div>
    <div id="SettingsContainer">
        <button class="favorite styled" type="button" onclick="convertAndSendJSON()">文章を校正する</button>
    </div>
    <!-- 以下デバッグ用 -->
    <div id="debug">
        <pre id="sendedItem">
            <!-- ここに送信されたJSONが表示される -->
        </pre>
    </div>
    <!-- デバッグ用 -->
    <div id="debug">
        <h3>送信データ:</h3>
        <div id="senedItem"></div>

        <h3>リクエストステータス:</h3>
        <div id="returnMessage"></div>

        <h3>受信データ:</h3>
        <div id="returnObj"><div>
    </div>

    <script>
        function convertAndSendJSON() {
            // 入力フォームからテキストを取得する
            const inputText = document.getElementById('inputSequenceForm').value;

            // 送信オブジェクト: JSON形式に変換する
            const jsonData = {
                text: inputText,
                config: {
                    check_duplication: true,
                    age: "high school"
                }
            };

            // 送信するデータ(jsonData)をHTML内デバッグ部分に表示
            document.getElementById('senedItem').textContent = JSON.stringify(jsonData, null, 2);

            // /send に入力テキストをJSONに加工して、backend側に送信する
            fetch('/send', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            })
                // beckendからのレスポンスを受け取る
                .then(response => response.text()) 
                .then(data => { // 
                    // 成功時:
                    // デバッグ用に受け取ったデータをコンソールに表示
                    console.log(data);
                    // 受け取ったデータを表示する
                    document.getElementById('returnObj').textContent = JSON.stringify(data, null, 2);
                    // 成功メッセージを表示
                    document.getElementById('returnMessage').textContent = '返ってきました！';
                })
                .catch(error => {
                    // 失敗時:
                    // エラーメッセージを表示
                    console.error('error:', error);
                    document.getElementById('returnMessage').textContent = 'エラーが発生しました。';
                });
        }
    </script>
</body>



</html>